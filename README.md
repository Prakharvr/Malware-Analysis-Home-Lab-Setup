# Malware Analysis Home Lab Setup


## Creating New Interface
VirtualBox GUI does not allow us to create more than four Network Interfaces

![image](https://miro.medium.com/v2/format:webp/1*8Ghj3mkvJTgvU3EFne0fPg.png)

However, we can configure up to 8 interfaces per VM. To add more than 4 interfaces we have to utilize the VirtualBox CLI.

## VirtualBox CLI Setup
The VirtualBox CLI binary is called **VBoxManage.exe.**

To be able to use the CLI we have to add its path as an environment variable.
VirtualBox is by default installed at >  **C:\Program Files\Oracle\VirtualBox.**

Copy the path to the executable from the navigation bar.

![image](https://miro.medium.com/v2/format:webp/1*neCssO3XL9JQKl1Y4AXhIw.png)

Open Search and type “Environment”. Click on **Edit environment variables for your account.**

![image](https://miro.medium.com/v2/format:webp/1*PpIk7SDYw7hcBQWIVpdCPQ.png)

In the top window select the variable named “Path” and then click on **Edit**.

![image](https://miro.medium.com/v2/format:webp/1*uyvaDoKK13eUB63xhuFYPw.png)

Click on **New** and then paste the path to the VirtualBox CLI. Then click on **OK**.

![image](https://miro.medium.com/v2/format:webp/1*Aa7ljO03eONDI63Fr0o6fw.png)

Click on **OK** to close the Environment Variables menu.

To test if the variable was added successfully open PowerShell and run the following command:
````bash
# List all installed VMs
VBoxManage list vms
````

![image](https://miro.medium.com/v2/format:webp/1*MtsY-qD0nDnVrHBHO9gDBw.png)

### Creating new Interface
Before we create the new interfaces we need to know the name of the pfSense VM (it is “pfSense” in my case). The VM should also be “Powered Off”.

![image](https://miro.medium.com/v2/format:webp/1*9DCMkCmcrFkTVFRuU6FA5g.png)

To add a network interface run the following commands:

````bash
# Create a Internet Network
VBoxManage modifyvm "pfSense" --nic5 intnet

# Use the Paravirtualized Adapter
VBoxManage modifyvm "pfSense" --nictype5 virtio

# Give it the name LAN 3
VBoxManage modifyvm "pfSense" --intnet5 "LAN 3"

# Network Interface is connected by Cable
VBoxManage modifyvm "pfSense" --cableconnected5 on
````

![image](https://miro.medium.com/v2/format:webp/1*nA7eO8g7CN3SJX7OSsy8iQ.png)

> In the above commands “pfSense” is the name of my VM.
> In the 3rd command in place of “LAN 3” you can use a different name that matches your network interface naming convention.


Now if we look at the overview of the pfSense VM we should see Adapter 5.

![image](https://miro.medium.com/v2/format:webp/1*i9JQvFzo7p1WwzbFJu4q2A.png)

> Interfaces that are created using the CLI will not show up in the Settings page for the VM. If you want to modify the adapter settings you have to do it using the CLI.

### Enabling the Interface
Start the pfSense VM. On boot, you will notice that there are still only 4 interfaces. The new interface has to be onboarded before it shows up in pfSense.

![image](https://miro.medium.com/v2/format:webp/1*ztcnz7mC7ek9Cnu4n3lVyQ.png)

Enter **1** to select "Assign Interfaces".
Should VLANs be set up now? **n**

![image](https://miro.medium.com/v2/format:webp/1*rm355cnzdp073m7eIGVgOQ.png)

Enter the WAN interface name: **vtnet0**
Enter the LAN interface name: **vtnet1**
Enter the Optional 1 interface name: **vtnet2**
Enter the Optional 2 interface name: **vtnet3**
Enter the Optional 3 interface name: **vtnet4**

![image](https://miro.medium.com/v2/format:webp/1*LEdz_xvINdKkzqhLzAeCgw.png)

Do you want to proceed?: **y**

![image](https://miro.medium.com/v2/format:webp/1*qQVbFjdtpTsXh8qlWXnnaQ.png)

The new interface has been added. Now we need to assign the interface an IP address.

![image](https://miro.medium.com/v2/format:webp/1*X1kBWT4gRKyrXzsIMaIdAg.png)

Enter **2** to select "Set interface(s) IP address"
Enter **5** to select the OPT3 interface.

![image](https://miro.medium.com/v2/format:webp/1*LkB2KhC9w5xf1aUScjFybg.png)

Configure IPv4 address OPT3 interface via DHCP?: **n***
Enter the new OPT3 IPv4 address: **10.99.99.1**
Enter the new OPT3 IPv4 subnet bit count: **24**

For the next question press **Enter**. Since we are configuring a LAN interface we do not have to worry about the upstream gateway.

![image](https://miro.medium.com/v2/format:webp/1*cfmkrW6mzNd56gyJTJKhgg.png)

Configure IPv6 address OPT3 interface via DHCP6: **n**
For the new OPT3 IPv6 address question press **Enter**.
Do you want to enable the DHCP server on OPT3?: **y**
Enter the start address of the IPv4 client address range: **10.99.99.11**
Enter the end address of the IPv4 client address range: **10.99.99.243**
Do you want to revert to HTTP as the webConfigurator protocol?: **n**

![image](https://miro.medium.com/v2/format:webp/1*HFkevh6gfGjdgRllXmv_ow.png)

Now interface OPT3 will have an IP address.

![image](https://miro.medium.com/v2/format:webp/1*CylG-_kssYXnRXC-SQsVyw.png)

### Renaming the Interface
Launch the Kali Linux VM. Login to the pfSense web portal. From the navigation bar select **Interfaces -> OPT3**.

![image](https://miro.medium.com/v2/format:webp/1*5nVP0iNCOlbaZ_kJ92vUkw.png)

In the description field enter **ISOLATED**. Scroll to the bottom and click on **Save**.

![image](https://miro.medium.com/v2/format:webp/1*Ki8o5wbVfl3nJDLnv8gFLQ.png)

Click on **Apply Changes** in the popup that appears to persist the changes.

![image](https://miro.medium.com/v2/format:webp/1*xeyql0ICeiE6LXxqXOKnSw.png)

### Interface Firewall Configuration
From the navigation bar click on **Firewall -> Rules**.

![image](https://miro.medium.com/v2/format:webp/1*FYvd4TV1MCJG6sHtRFQRHQ.png)

Select the **ISOLATED** tab. Click on the "Add" button to create a new rule.

![image](https://miro.medium.com/v2/format:webp/1*MQxKa0j9DZrV9efuOJydAA.png)

Change the values as follows:
Action: **Block**
Address Family: **IPv4+IPv6**
Protocol: **Any**
Source: **ISOLATED subnets**
Description: **Block access to everything**

Scroll to the bottom and click on **Save**.

![image](https://miro.medium.com/v2/format:webp/1*yUM_x4vJ4gAuQQfEhFRqSw.png)

In the popup click on **Apply Changes** to persist the new rule.

![image](https://miro.medium.com/v2/format:webp/1*vuNInn6wnQm_6qw4lRjzsA.png)

![image](https://miro.medium.com/v2/format:webp/1*7XP6hjNpndj8GpUYL53CnQ.png)

> Since this Interface is going to be used for Malware Analysis we are blocking network access. This will ensure that malware cannot spread to other systems using the network.

## Flare VM Setup
To install Flare we need a Windows machine. Flare can be set up using most versions of Windows. Since we already have the ISO for Windows 10 Enterprise I will be using it to configure Flare.

### Windows ISO Download
Go to the following URL: [Windows 10 Enterprise | Microsoft Evaluation Center](https://www.microsoft.com/en-us/evalcenter/download-windows-10-enterprise)

Click on the 64-bit edition Enterprise ISO download option. The ISO file is ~5GB.

![image](https://miro.medium.com/v2/format:webp/1*scs8pGkN-tKq36mS1vbTNQ.png)

### Creating the VM
Select Tools from the sidebar and click on **New**.

![image](https://miro.medium.com/v2/format:webp/1*EP2aLfgaulHo8dQ0xaGY2Q.png)

Give the VM a name. Select the downloaded Windows 10 ISO Image. Check “Skip Unattended Installation”. Then click on **Next**.

![image](https://miro.medium.com/v2/format:webp/1*Ruh2ZhCbCFzT534QjNUM5w.png)

Increase Base Memory to **4096MB** and click on **Next**.

![image](https://miro.medium.com/v2/format:webp/1*0GoQy9xA3VrDzW_AjN-6Fg.png)

Increase the Drive Size to **100GB** and click on **Next**.

![image](https://miro.medium.com/v2/format:webp/1*-MG-JbGcpLvapRS7-ZHERg.png)

Verify all the settings and click on **Finish**.

![image](https://miro.medium.com/v2/format:webp/1*t_WJ-M5HBVU7RCvqDoZ50Q.png)

### Adding VM to Group
Right-click on the VM and select Move to > **Group -> [New]**.

![image](https://miro.medium.com/v2/format:webp/1*0sRNSD4HZWf4qh-rawxl6Q.png)

Right-click on the group and rename it to “Malware Analysis”.

![image](https://miro.medium.com/v2/format:webp/1*u5WymGR8c41xrRNPi6XunA.png)

Right-click on the “Malware Analysis” group and select Move to **Group -> Home Lab**.

The final result should look as follows:

![image](https://miro.medium.com/v2/format:webp/1*9e82oNeE62XIVH74_dgp-g.png)

### Configuring the VM
Select the VM then from the toolbar select **Settings**.

![image](https://miro.medium.com/v2/format:webp/1*6yuqhixFKt5IxJEot-ADAw.png)

Go to **System -> Motherboard**. In the Boot Order field ensure that **Hard Disk** is on the top followed by **Optical**. Uncheck **Floppy**.

![image](https://miro.medium.com/v2/format:webp/1*FLhTeR4PG_JYuYKThA42CA.png)

Leave the **Network Adatper** on its default setting of **NAT.**

![image](https://miro.medium.com/v2/format:webp/1*eJrK9xe4t0HgIdAxYVG4rg.png)

> Machines assigned to the **ISOLATED** interface does not have internet connection. But to setup Flare we need Internet access. Once we finish the configuring Flare we will move it to the correct subnet

Click on **OK** to save the settings.

### Installing Windows
Select the Flare VM from the sidebar and click on **Start**.

![iamge](https://miro.medium.com/v2/format:webp/1*19rJ615JZwMfL__IzteuXQ.png)


![image](https://miro.medium.com/v2/format:webp/1*39Tweudwha1_h58ZXKB2Pg.png)

![image](https://miro.medium.com/v2/format:webp/1*A1lK63vd-p_gSxPcyFlMww.png)

![image](https://miro.medium.com/v2/format:webp/1*sacvHDhJyBMAgAl1t6G2UQ.png)

![image](https://miro.medium.com/v2/format:webp/1*UF-ZpT3IAt-qFDo0vWvYDQ.png)

![image](https://miro.medium.com/v2/format:webp/1*rnQ2O4F_G85yeBX6bN7Imw.png)

![image](https://miro.medium.com/v2/format:webp/1*HO_gZbvXIwwZw_JuB2OZ5Q.png)

Select “Domain join instead”.

![image](https://miro.medium.com/v2/format:webp/1*CHbaw69I_bdxLsIsKJRBNQ.png)

> Provide a name that does not use special characters and spaces. This is very important. The installer for Flare will not work otherwise.

![image](https://miro.medium.com/v2/format:webp/1*XX0Fru6wiKQGQldmt1UR_Q.png)

![image](https://miro.medium.com/v2/format:webp/1*etCgtX7pqJQzCUf2eVp06Q.png)

![image](https://miro.medium.com/v2/format:webp/1*sqNZgJe2TLmPYNzz9tgv5A.png)

![image](https://miro.medium.com/v2/format:webp/1*ooYTSvuaL6KJehJhu5cipw.png)

Once on the desktop Windows will ask should access to the Internet be allowed click on **Yes**.

### Guest Additions Installation
Install Guest Additions to enable the resizing on the VM display. 

![image](https://miro.medium.com/v2/format:webp/1*A9iWHDSmmlVNMmRUzcAmNg.png)

![image](https://miro.medium.com/v2/format:webp/1*GRcRcwp0D9XAzYv2pRofEA.png)

![image](https://miro.medium.com/v2/format:webp/1*gGV6S0qy-NCZaaqNXPDxDw.png)

![image](https://miro.medium.com/v2/format:webp/1*YGlplY_0BsslJklp45jd0A.png)

![image](https://miro.medium.com/v2/format:webp/1*Pyjpo5RA9vYbWA5QH2H-iw.png)

![image](https://miro.medium.com/v2/format:webp/1*pach_ogn4vL6pkYYD1A9hw.png)

After rebooting the VM. Remove the Guest Addition Image.

![image](https://miro.medium.com/v2/format:webp/1*QjLKwHX-t5wJI7Rcoum2Xg.png)

### Creating VM Snapshot 1
Before we proceed we are going to take a snapshot of the VM. Snapshots allow us to roll back to an old functional state of the VM.

Shut down the VM. Click on the Hamburger menu on the right of the VM name in the sidebar. Select **Snapshots**.

![image](https://miro.medium.com/v2/format:webp/1*9y9SLq-H0mPvqJKPg8w8jw.png)

Click on **Take**.

![image](https://miro.medium.com/v2/format:webp/1*6Toj_Atf6P8PaOg2_EleFA.png)

Give the Snapshot a descriptive name. Click on **OK** to create the Snapshot.

![image](https://miro.medium.com/v2/format:webp/1*myYn6p3YPacu8glc9hlmIw.png)

Click on the Hamburger menu and click on **Details** to return to the original page.

### Flare VM Pre-Install Configuration
You can read more about Flare VM and its pre-requisites on the below link:

Open on Search bar and search for “Settings”. Open the Settings app.
![image](https://miro.medium.com/v2/format:webp/1*T7tWPGEzbAYeWOp7AvFkCg.png)

Click on “Update & Security”.

![image](https://miro.medium.com/v2/format:webp/1*AoV1k3dT5qVEKiLLxB4Lsg.png)

Click on the “Pause updates for 7 days” button.

![image](https://miro.medium.com/v2/format:webp/1*YgVcGs3czsmI6jXRK5RTVA.png)

## Disabling Windows Defender
Download the following script:

Right-click on the Shield icon on the taskbar and select “View Security Dashboard”.

![image](https://miro.medium.com/v2/format:webp/1*73gPiqzSuKboHbMJ0eOgXQ.png)

Click on “Virus & threat protection”.

![image](https://miro.medium.com/v2/format:webp/1*Es2dQ3MsRTJW89j0iopcLQ.png)

Select “Manage settings” from the “Virus & threat protection settings” section.

![image](https://miro.medium.com/v2/format:webp/1*kWEOKCqE7A4nR-9ybyvcag.png)

Disable all the features that are shown in the image below:

![image](https://miro.medium.com/v2/format:webp/1*qqIfNVoocAF2MIwqZtRJAg.png)

Right-click on the Start menu and select “Windows PowerShell (Admin)”.

![image](https://miro.medium.com/v2/format:webp/1*fIiZX_mDV5zHudm6uf6DoQ.png)

Run the following command from PowerShell to download the script:

````powershell
# Save the script in the Downloads folder
Invoke-WebRequest "https://raw.githubusercontent.com/jeremybeaume/tools/master/disable-defender.ps1" -OutFile $HOME\Downloads\disable-defender.ps1
````

![image](https://miro.medium.com/v2/format:webp/1*ZSEiLbrQeOIvF_tge1O-6Q.png)

Use the shortcut **Windows+R** to open the Run dialog. Enter **msconfig** and click on **OK**.

![image](https://miro.medium.com/v2/format:webp/1*pZ2ofSKOiP3fuHqrURs7QA.png)

Navigate to the Boot tab. In the Boot options section enable “Safe boot” and then click on ***OK** to save changes.

![image](https://miro.medium.com/v2/format:webp/1*B4B0kE0m7VNKgsiiHlLGTw.png)

Click on **Restart** to boot into Safe Mode.

![image](https://miro.medium.com/v2/format:webp/1*PF0H7mCx37g1uGPhExiACQ.png)

In Safe Mode, the VM cannot be resizable. Safe Mode essentially disables all features that are not required to run the OS.

![image](https://miro.medium.com/v2/format:webp/1*GCi5HqcG9Coi8erGSpz37Q.png)

Right-click on the Start menu and select “Windows PowerShell (Admin)” and enter the following commands:

````powershell
# Change directory
cd .\Downloads\

# Unblock the downloaded script
Unblock-File .\disable-defender.ps1

# Disable the PowerShell policy preventing script execution 
Set-ExecutionPolicy Unrestricted -Force

# Start the script
.\disable-defender.ps1
````

![image](https://miro.medium.com/v2/format:webp/1*F0e9dwV51UqS5ZyUH6cPPg.png)

Once the script completes its execution press Enter to close the script. Reboot the VM for the changes to take place.

![image](https://miro.medium.com/v2/format:webp/1*UtLCML5QN8ePcCmI_jSTJw.png)

Press **Windows+R** to open the Run dialog. Enter **msconfig** and click on **OK**.

Navigate to the Boot tab. From the Boot options section disable “Safe boot”. Click on **Apply** then **OK**. Restart the VM to boot normally into Windows.

![image](https://miro.medium.com/v2/format:webp/1*l22EezG6bjXIICpy04j7Tg.png)

Wait for some time for Defender to load completely and then you will see that “Virus & threat protection” will show as disabled. This means that the script worked successfully.

![image](https://miro.medium.com/v2/format:webp/1*AW7fTExW0oDUWCi-XVpyrQ.png)

###  Renaming the VM
Search for “This PC” and from the right side click on “Properties”.

Select “Rename this PC”.

![image](https://miro.medium.com/v2/format:webp/1*F4qaZ0QeRCboE0KVGh4X3g.png)

Give the PC a name. Click on **Next** and then select "Restart Now" for the changes to take effect.

![image](https://miro.medium.com/v2/format:webp/1*U3lQDDodmU8rlwQEEcxyOQ.png)

### Creating VM Snapshot **2**
Shut down the VM. Go to the Snapshot page using the Hamburger menu. Click on Take to create a new Snapshot.

![image](https://miro.medium.com/v2/format:webp/1*dDw-tblwzBp-PYmgEGQ3Cw.png)

Give the Snapshot a descriptive name. Then click on **OK**.

![image](https://miro.medium.com/v2/format:webp/1*UVyUyxV_k5pDYeBc-kJSCQ.png)

Use the Hamburger menu and return to the Details page. Click on Start to **start** the VM.

**Flare VM Installation**
Right-click on the Start menu and select “Windows PowerShell (Admin)”.

![image](https://miro.medium.com/v2/format:webp/1*fIiZX_mDV5zHudm6uf6DoQ.png)

Enter the following commands to download and run the Flare VM script.

````powershell
# Download the FlareVM script
Invoke-WebRequest "https://raw.githubusercontent.com/mandiant/flare-vm/main/install.ps1" -OutFile $HOME/Downloads/install.ps1

# Go to Downloads Folder
cd $HOME/Downloads

# Unlock the downlaoded script
Unblock-File .\install.ps1

# Disable PowerShell script execution policy 
Set-ExecutionPolicy Unrestricted -Force

# Run the script
.\install.ps1
````

![image](https://miro.medium.com/v2/format:webp/1*B7UUAbGC7tKQgL085XdzTQ.png)

The script will make some checks before starting the installation.

Enter **Y** when asked about Snapshot. Enter password when prompted.

![image](https://miro.medium.com/v2/format:webp/1*0sibgbD3c7k1-mZyhT5HRw.png)

After some time the Flare VM configuration dialog will open.
![image](https://miro.medium.com/v2/format:webp/1*ZDe-KK3fFWpHn4AnTKnpwg.png)


In the Package Installation Customization section from the left side select “debloat.vm” and click on the right arrow to select it for installation

![image](https://miro.medium.com/v2/format:webp/1*NBdHs-FUeQEBhty0Dvxv5w.png)


Click on **OK** to start the install. The VM will restart multiple times during the setup.

![image](https://miro.medium.com/v2/format:webp/1*86Shd1mXEp6LkvIuMFr0ng.png)

The installation can take a very long time. Once the setup is complete we will get the following prompt click on Finish to complete the setup.

![image](https://miro.medium.com/v2/format:webp/1*C0qI19Z3GMeUZrOlDAyPhg.png)

After the installation is complete. Restart the VM to complete the setup.

![image](https://miro.medium.com/v2/format:webp/1*Bgdu1W_hikczxKX7QYiC6Q.png)

## Post-Install Configuration
## Installing OpenSSH Server
Once we move this VM to the **ISOLATED** subnet it will not be able to access the internet. We will not be able to download malware samples directly from the Internet. We will download the samples onto a different VM that has Internet access and then move them to this machine using SSH. I will cover this process in more detail in a later module. For now, we need to install "OpenSSH Server".

Open the Search bar. Type “Add” and from the results select the “Add or remove programs” option.

![image](https://miro.medium.com/v2/format:webp/1*uYnSTZk8X4WYgnFPCD4UWA.png)

Click on **Optional Features** under "Apps & features".

![image](https://miro.medium.com/v2/format:webp/1*-9ohJvIFWSwzcK2ssi8cug.png)

Click on **Add a feature**. This will open a new menu.

![image](https://miro.medium.com/v2/format:webp/1*s06YQAGRNV7ZlnqsfVZqoQ.png)

Search for “SSH”. Enable “OpenSSH Server” and then click on **Install**.

![image](https://miro.medium.com/v2/format:webp/1*tfrw5r0MJWl-7fJJNIuieA.png)

Once the install is complete if you search for “SSH” in the “Installed features” section you should see “OpenSSH Client” and “OpenSSH Server”.

![image](https://miro.medium.com/v2/format:webp/1*XS_hfppo4e2DQa4BBNxhEA.png)

### Moving VM to the Isolated Network
Shut down the VM. Open the VM **Settings** page and go to **Network**. For the Attached to field select **Internal Network**. For name select **LAN 3**. Click on **OK** to save the changes.

![image](https://miro.medium.com/v2/format:webp/1*e2cUoABHFr2i0hHjibVYfw.png)

### Creating VM Snapshot 3
Using the Hamburger menu open the Snapshot page. Click on **Take** to create a Snapshot. Give the Snapshot a descriptive name and then click on **Ok**.

![image](https://miro.medium.com/v2/format:webp/1*XkGNWuxOSwNEFKPzKXFsew.png)

![image](https://miro.medium.com/v2/format:webp/1*85j4orozCHzRtBT-dg3Vlg.png)

You can now delete the Windows 10 Enterprise ISO if you do not plan to store it in the future.

## REMnux VM Setup
### Download Image
Go to the following link: [Get the Virtual Appliance — REMnux Documentation](https://docs.remnux.org/install-distro/get-virtual-appliance)

Click on Box to open the download page.

![image](https://miro.medium.com/v2/format:webp/1*dPz4fI5hfUSTtUPVoAz2-Q.png)

Click on the blue Download button. The image is ~5GB.

![image](https://miro.medium.com/v2/format:webp/1*AlyoLf9b_M_W4J2eV9tBRA.png)

Once the download is complete we will have an **.ova** file.

![image](https://miro.medium.com/v2/format:webp/1*Qj5nGuNshQZTUbbszTknCw.png)

### Creating the VM
Click on Tools from the sidebar and then select **Import**.

![image](https://miro.medium.com/v2/format:webp/1*GJG54BW9trHeViyRuOLWqQ.png)

Select the downloaded OVA file and click on **Next**.

![image](https://miro.medium.com/v2/format:webp/1*DJroJlUkr7BWi7fDiYBOHw.png)


Configure the VM as required. Ensure the VM has **4096MB** of RAM. For the MAC Address Policy select "Generate new MAC addresses for all network adapters" then click on **Finish**.

![image](https://miro.medium.com/v2/format:webp/1*zVyL5sE3dAwgN6J7bh6NnQ.png)

## Adding VM to Group
Once the import is complete right-click on the VM and select Move to > **Group -> Home Lab/Malware Analysis**

![image](https://miro.medium.com/v2/format:webp/1*ed29pB5OIu09uQKYLZIrbg.png)

### Configuring the VM
Select the VM then click on **Settings** from the toolbar.

Go to **System -> Motherboard**. In Boot Order ensure that **Hard Disk** is on the top followed by **Optical**. Uncheck **Floppy**. Click on **OK** to save the changes.

![image](https://miro.medium.com/v2/format:webp/1*m4zgsU3lN4tFzFWxngtv-Q.png)

### Post-Install Configuration
Select the VM and from the toolbar click on Start.

![image](https://miro.medium.com/v2/format:webp/1*r5qy2gnX90GkbZvBsY8XEQ.png)

Updating Guest Additions
The VM will already have Guest Additions installed but it will be an older version. From the VM toolbar select **Devices -> Upgrade Guest Additions** to update Guest Additions.

![image](https://miro.medium.com/v2/format:webp/1*nf6qsjW-lItnzxlqZd6_Jg.png)

### Upgrading Packages
Once Guest Additions is updated open a Terminal and enter the following command to update the system packages.

`````bash
remnux upgrade
`````
![image](https://miro.medium.com/v2/format:webp/1*FwloZnv-GcHqXHSOVyLYMA.png)

Once the update is complete restart the VM.

![image](https://miro.medium.com/v2/format:webp/1*Tb05yHg-IIVgU26EwajkOQ.png)

![image](https://miro.medium.com/v2/format:webp/1*OHatTt3dvh3hqEHXEp559w.png)

### Moving VM to the Isolated Network
Shut down the VM. Open the **Settings** menu and select **Network**.

For the Attached to option select **Internal Network**. For the name field select **LAN 3**. Click on **OK** to save the changes. This will move the VM to the **ISOLATED** interface that does not have internet access.

![image](https://miro.medium.com/v2/format:webp/1*jBWn_W6wdzcNf7AlRrLHjQ.png)

### Creating VM Snapshot
Click on the Hamburger menu and select **Snapshot**.

![image](https://miro.medium.com/v2/format:webp/1*WGFiN9NCvDi9JhploU3kfg.png)

Click on **Take** to create a Snapshot.

![image](https://miro.medium.com/v2/format:webp/1*n6x0EEsHY2p8UdXu-0SMGw.png)

Give the Snapshot a descriptive name. Then click on **OK**.

![image](https://miro.medium.com/v2/format:webp/1*Z9C010xN7jLVcSzbUFAkIQ.png)

![image](https://miro.medium.com/v2/format:webp/1*IJJjN__ejdNLtlCtRuk0vg.png)

